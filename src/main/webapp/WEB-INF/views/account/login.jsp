<%@ page contentType="text/html;charset=UTF-8" %><%@ page import="org.apache.shiro.web.filter.authc.FormAuthenticationFilter"%><%@ page import="org.apache.shiro.authc.ExcessiveAttemptsException"%><%@ page import="org.apache.shiro.authc.IncorrectCredentialsException"%><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %><c:set var="ctx" value="${pageContext.request.contextPath}"/><!DOCTYPE html><!--[if IE 8]> <html lang="en" class="ie8"> <![endif]--><!--[if IE 9]> <html lang="en" class="ie9"> <![endif]--><!--[if !IE]><!--> <html lang="en"> <!--<![endif]--><!-- BEGIN HEAD --><head>	<meta charset="utf-8" />	<title>apqt</title>	<meta content="width=device-width, initial-scale=1.0" name="viewport" />	<meta content="" name="description" />	<meta content="" name="author" />	<!-- BEGIN GLOBAL MANDATORY STYLES -->	<link href="${ctx}/static/metronic/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/style-metro.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/style.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/style-responsive.css" rel="stylesheet" type="text/css"/>	<link href="${ctx}/static/metronic/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>	<link href="${ctx}/static/metronic/css/uniform.default.css" rel="stylesheet" type="text/css"/>	<!-- END GLOBAL MANDATORY STYLES -->	<!-- BEGIN PAGE LEVEL STYLES -->	<link href="${ctx}/static/metronic/css/login.css" rel="stylesheet" type="text/css"/>	<!-- END PAGE LEVEL STYLES -->	<link rel="shortcut icon" href="${ctx}/static/metronic/image/favicon.ico" />	</head><!-- END HEAD --><!-- BEGIN BODY --><body class="login">	<!-- BEGIN LOGO -->	<div class="logo">	&nbsp;	</div>	<!-- END LOGO -->	<!-- BEGIN LOGIN -->	<div class="content">		<!-- BEGIN LOGIN FORM -->				<div class="logo" style="margin-top: 10px;">		<img src="${ctx}/static/metronic/image/logo-104-74.png" alt="" /> 		<br/>		<br/>	</div>		<form id="login-form" class="form-vertical login-form" action="${ctx}/login" method="post" >									<h4 class="form-title">登录系统</h4>			<%			String error = (String) request.getAttribute(FormAuthenticationFilter.DEFAULT_ERROR_KEY_ATTRIBUTE_NAME);			if(error != null){				//out.println(error);			%>				<div class="alert alert-error">					<button class="close" data-dismiss="alert"></button>					<sapn>登录失败，请重试？</sapn>				</div>			<%			}			%>			<div class="alert alert-error hide">				<button class="close" data-dismiss="alert"></button>				<span>请输入用户名称和密码.</span>			</div>			<div class="control-group">				<!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->				<label class="control-label visible-ie8 visible-ie9">用户名称</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-user"></i>						<input class="m-wrap placeholder-no-fix" type="text" value="" placeholder="用户名称" name="username"/>					</div>				</div>			</div>			<div class="control-group">				<label class="control-label visible-ie8 visible-ie9">密码</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-lock"></i>						<input class="m-wrap placeholder-no-fix" type="password" value="" placeholder="密码" name="password"/>					</div>				</div>			</div>			<div class="form-actions"><!-- 				<label class="checkbox">					<input type="checkbox" id="remember" name="rememberMe" /> 记住我				</label> -->				<button type="submit" class="btn green pull-right">				登录 <i class="m-icon-swapright m-icon-white"></i>				</button>            			</div>			<!-- 			<div class="forget-password">				<h4>忘记密码 ?</h4>				<p>					别担心,  <a href="javascript:;" class="" id="forget-password">找回密码</a>				</p>			</div> -->			<!-- 			<div class="create-account">				<p>					还没有账号吗 ?&nbsp; 					<a href="javascript:;" id="register-btn" class="">创建账号</a>				</p>			</div>			 -->		</form>		<!-- END LOGIN FORM -->        		<!-- BEGIN FORGOT PASSWORD FORM -->		<form class="form-vertical forget-form" action="${ctx}/login">			<h3 class="">Forget Password ?</h3>			<p>Enter your e-mail address below to reset your password.</p>			<div class="control-group">				<div class="controls">					<div class="input-icon left">						<i class="icon-envelope"></i>						<input class="m-wrap placeholder-no-fix" type="text" placeholder="Email" name="email" />					</div>				</div>			</div>			<div class="form-actions">				<button type="button" id="back-btn" class="btn">				<i class="m-icon-swapleft"></i> Back				</button>				<button type="submit" class="btn green pull-right">				Submit <i class="m-icon-swapright m-icon-white"></i>				</button>            			</div>		</form>		<!-- END FORGOT PASSWORD FORM -->		<!-- BEGIN REGISTRATION FORM -->		<form class="form-vertical register-form" action="${ctx}/register" method="post" >			<h3 class="">注册</h3>			<p>请输入注册账号的详细信息:</p>			<div class="control-group">				<label class="control-label visible-ie8 visible-ie9">用户名称</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-user"></i>						<input class="m-wrap placeholder-no-fix" type="text" placeholder="用户名称" name="loginName"/>					</div>				</div>			</div>			<div class="control-group">				<label class="control-label visible-ie8 visible-ie9">密码</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-lock"></i>						<input class="m-wrap placeholder-no-fix" type="password" id="register_password" placeholder="密码" name="plainPassword"/>					</div>				</div>			</div>			<div class="control-group">				<label class="control-label visible-ie8 visible-ie9">重新输入一遍密码</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-ok"></i>						<input class="m-wrap placeholder-no-fix" type="password" placeholder="重新输入一遍密码" name="confirmPassword"/>					</div>				</div>			</div><!-- 			<div class="control-group">				<label class="control-label visible-ie8 visible-ie9">邮箱</label>				<div class="controls">					<div class="input-icon left">						<i class="icon-envelope"></i>						<input class="m-wrap placeholder-no-fix" type="text" placeholder="邮箱" name="email"/>					</div>				</div>			</div> -->			<div class="control-group">				<div class="controls">					<label class="checkbox">					<input type="checkbox" name="tnc"/> 我同意 <a href="#">服务条款</a> 和 <a href="#">隐私策略</a>					</label>  					<div id="register_tnc_error"></div>				</div>			</div>			<div class="form-actions">				<button id="register-back-btn" type="button" class="btn">				<i class="m-icon-swapleft"></i>  返回				</button>				<button type="submit" id="register-submit-btn" class="btn green pull-right">				注册 <i class="m-icon-swapright m-icon-white"></i>				</button>            			</div>		</form>		<!-- END REGISTRATION FORM -->	</div>	<!-- END LOGIN -->	<!-- BEGIN COPYRIGHT -->	<div class="copyright">	<!-- 		技术支持&nbsp;&nbsp;<a href="#" style="color: #1894D3;">微码科技</a>		 -->	</div>	<!-- END COPYRIGHT -->	<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->	<!-- BEGIN CORE PLUGINS -->	<script src="${ctx}/static/metronic/js/jquery-1.10.1.min.js" type="text/javascript"></script>	<script src="${ctx}/static/metronic/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>	<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->	<script src="${ctx}/static/metronic/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>      	<script src="${ctx}/static/metronic/js/bootstrap.min.js" type="text/javascript"></script>	<!--[if lt IE 9]>	<script src="${ctx}/static/metronic/js/excanvas.min.js"></script>	<script src="${ctx}/static/metronic/js/respond.min.js"></script>  	<![endif]-->   	<script src="${ctx}/static/metronic/js/jquery.slimscroll.min.js" type="text/javascript"></script>	<script src="${ctx}/static/metronic/js/jquery.blockui.min.js" type="text/javascript"></script>  	<script src="${ctx}/static/metronic/js/jquery.cookie.min.js" type="text/javascript"></script>	<script src="${ctx}/static/metronic/js/jquery.uniform.min.js" type="text/javascript" ></script>	<!-- END CORE PLUGINS -->	<!-- BEGIN PAGE LEVEL PLUGINS -->	<script src="${ctx}/static/metronic/js/jquery.validate.min.js" type="text/javascript"></script>		<script src="${ctx}/static/metronic/js/messages_zh.js" type="text/javascript"></script>	<!-- END PAGE LEVEL PLUGINS -->	<!-- BEGIN PAGE LEVEL SCRIPTS -->	<script src="${ctx}/static/metronic/js/app.js" type="text/javascript"></script>	<script src="${ctx}/static/metronic/js/login.js" type="text/javascript"></script>      	<!-- END PAGE LEVEL SCRIPTS --> 	<script>		jQuery(document).ready(function() {     					  App.init();		  Login.init("${ctx}/login","${ctx}/register");		  		  //聚焦第一个输入框		  $("#username").focus();		});	</script>		<script>	var Login = function () {	    	    return {	        //main function to initiate the module	        init: function (loginUrl,registerUrl) {	        		           $('.login-form').validate({		            errorElement: 'label', //default input error message container		            errorClass: 'help-inline', // default input error message class		            focusInvalid: false, // do not focus the last invalid input		            rules: {		                username: {		                    required: true		                },		                password: {		                    required: true		                },		                remember: {		                    required: false		                }		            },		            messages: {		                username: {		                    required: "请输入用户名称"		                },		                password: {		                    required: "请输入密码"		                }		            },		            invalidHandler: function (event, validator) { //display error alert on form submit   		                $('.alert-error', $('.login-form')).show();		            },		            highlight: function (element) { // hightlight error inputs		                $(element)		                    .closest('.control-group').addClass('error'); // set error class to the control group		            },		            success: function (label) {		                label.closest('.control-group').removeClass('error');		                label.remove();		            },		            errorPlacement: function (error, element) {		                error.addClass('help-small no-left-padding').insertAfter(element.closest('.input-icon'));		            },		            //submitHandler: function (form) {		            //    window.location.href = loginUrl;		            //}		        });		        $('.login-form input').keypress(function (e) {		            if (e.which == 13) {		                if ($('.login-form').validate().form()) {		                    //window.location.href = loginUrl;		                	$("#login-form").submit();		                }		                return false;		            }		        });		        $('.forget-form').validate({		            errorElement: 'label', //default input error message container		            errorClass: 'help-inline', // default input error message class		            focusInvalid: false, // do not focus the last invalid input		            ignore: "",		            rules: {		                email: {		                    required: true,		                    email: true		                }		            },		            messages: {		                email: {		                    required: "请输入邮箱."		                }		            },		            invalidHandler: function (event, validator) { //display error alert on form submit   		            },		            highlight: function (element) { // hightlight error inputs		                $(element)		                    .closest('.control-group').addClass('error'); // set error class to the control group		            },		            success: function (label) {		                label.closest('.control-group').removeClass('error');		                label.remove();		            },		            errorPlacement: function (error, element) {		                error.addClass('help-small no-left-padding').insertAfter(element.closest('.input-icon'));		            },		            submitHandler: function (form) {		                window.location.href = "${ctx}";		            }		        });		        $('.forget-form input').keypress(function (e) {		            if (e.which == 13) {		                if ($('.forget-form').validate().form()) {		                    window.location.href = "${ctx}";		                }		                return false;		            }		        });		        jQuery('#forget-password').click(function () {		            jQuery('.login-form').hide();		            jQuery('.forget-form').show();		        });		        jQuery('#back-btn').click(function () {		            jQuery('.login-form').show();		            jQuery('.forget-form').hide();		        });		        $('.register-form').validate({		            errorElement: 'label', //default input error message container		            errorClass: 'help-inline', // default input error message class		            focusInvalid: false, // do not focus the last invalid input		            ignore: "",		            rules: {		                loginName: {							remote: "${ctx}/register/checkLoginName"						},		                plainPassword: {		                    required: true		                },		                confirmPassword: {		                    equalTo: "#register_password"		                },		                email: {		                    required: true,		                    email: true		                },		                tnc: {		                    required: true		                }		            },		            messages: { // custom messages for radio buttons and checkboxes		                tnc: {		                    required: "请接受服务条款和隐私策略."		                },		                loginName: {							remote: "用户登录名已存在"						}		            },		            invalidHandler: function (event, validator) { //display error alert on form submit   		            },		            highlight: function (element) { // hightlight error inputs		                $(element)		                    .closest('.control-group').addClass('error'); // set error class to the control group		            },		            success: function (label) {		                label.closest('.control-group').removeClass('error');		                label.remove();		            },		            errorPlacement: function (error, element) {		                if (element.attr("name") == "tnc") { // insert checkbox errors after the container                  		                    error.addClass('help-small no-left-padding').insertAfter($('#register_tnc_error'));		                } else {		                    error.addClass('help-small no-left-padding').insertAfter(element.closest('.input-icon'));		                }		            }		            //submitHandler: function (form) {		                //window.location.href = "${ctx}";		            //}		        });		        jQuery('#register-btn').click(function () {		            jQuery('.login-form').hide();		            jQuery('.register-form').show();		        });		        jQuery('#register-back-btn').click(function () {		            jQuery('.login-form').show();		            jQuery('.register-form').hide();		        });	        }	    };	}();	</script>	<!-- END JAVASCRIPTS<script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-37564768-1']);  _gaq.push(['_setDomainName', 'keenthemes.com']);  _gaq.push(['_setAllowLinker', true]);  _gaq.push(['_trackPageview']);  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script> --></body><!-- END BODY --></html>